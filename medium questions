-- company_code, founder name, total number of lead managers, total number of senior managers, total number of managers, and total number of employees. Order your output by ascending
SELECT COMPANY.COMPANY_CODE,COMPANY.FOUNDER,COUNT(DISTINCT LEAD_MANAGER_CODE),COUNT(DISTINCT SENIOR_MANAGER_CODE),COUNT(DISTINCT MANAGER_CODE),COUNT(DISTINCT EMPLOYEE_CODE)
FROM COMPANY JOIN EMPLOYEE 
ON COMPANY.COMPANY_CODE=EMPLOYEE.COMPANY_CODE
GROUP BY COMPANY.FOUNDER,COMPANY.COMPANY_CODE
ORDER BY COMPANY.COMPANY_CODE

--A median is defined as a number separating the higher half of a data set from the lower half. Query the median of the Northern Latitudes (LAT_N) from STATION and round your answer to  decimal places.
SET @TABLESIZE := (SELECT COUNT(LAT_N) FROM STATION); 
--paranthesis ensures it is a subquery and it feteches a single value and assign it to variable,without it sql throws error
SELECT ROUND(AVG(LAT_N),4)
FROM (SELECT LAT_N, ROW_NUMBER() OVER(ORDER BY LAT_N) AS RN FROM STATION) TEMP
WHERE(
     CASE WHEN MOD(@TABLESIZE,2)!=0 
          THEN 
              RN = (@TABLESIZE+1)/2
          WHEN MOD(@TABLESIZE,2)=0 
          THEN 
              RN IN (ROUND(@table_size / 2, 0), ROUND(@table_size / 2, 0) + 1)
--in checks if value exists in list the result includes all the rows with thosevalues
      END
    );
